<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.81.0"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Chaper 2 :: DJMol Docs</title><link href=/css/nucleus.css?1615995166 rel=stylesheet><link href=/css/fontawesome-all.min.css?1615995166 rel=stylesheet><link href=/css/hybrid.css?1615995166 rel=stylesheet><link href=/css/featherlight.min.css?1615995166 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1615995166 rel=stylesheet><link href=/css/auto-complete.css?1615995166 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1615995166 rel=stylesheet><link href=/css/theme.css?1615995166 rel=stylesheet><link href=/css/hugo-theme.css?1615995166 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1615995166></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/documentation/chapter2/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><h1>DJMol</h1></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label><input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1615995166></script><script type=text/javascript src=/js/auto-complete.js?1615995166></script><script type=text/javascript>var baseurl="https://djmolprogram.github.io"</script><script type=text/javascript src=/js/search.js?1615995166></script></div><section id=homelinks><ul><li><a class=padding href=/><i class="fas fa-home"></i>Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/installation/ title=Installation class=dd-item><a href=/installation/>Installation</a><ul><li data-nav-id=/installation/requirements/ title="System Requirements" class=dd-item><a href=/installation/requirements/>System Requirements</a></li></ul></li><li data-nav-id=/documentation/ title=Documentation class="dd-item
parent"><a href=/documentation/>Documentation</a><ul><li data-nav-id=/documentation/chapter1/ title="Chaper 1" class=dd-item><a href=/documentation/chapter1/>Chaper 1</a></li><li data-nav-id=/documentation/chapter2/ title="Chaper 2" class="dd-item active"><a href=/documentation/chapter2/>Chaper 2</a></li><li data-nav-id=/documentation/chapter3/ title="Chaper 3" class=dd-item><a href=/documentation/chapter3/>Chaper 3</a></li><li data-nav-id=/documentation/chapter4/ title="Chaper 4" class=dd-item><a href=/documentation/chapter4/>Chaper 4</a></li><li data-nav-id=/documentation/chapter5/ title="Chaper 5" class=dd-item><a href=/documentation/chapter5/>Chaper 5</a></li><li data-nav-id=/documentation/chapter6/ title="Chaper 6" class=dd-item><a href=/documentation/chapter6/>Chaper 6</a></li><li data-nav-id=/documentation/chapter7/ title="Chaper 7" class=dd-item><a href=/documentation/chapter7/>Chaper 7</a></li><li data-nav-id=/documentation/chapter8/ title="Chaper 8" class=dd-item><a href=/documentation/chapter8/>Chaper 8</a></li></ul></li></ul><section id=footer><p>2021, GP Krishna Mohan, Rahul Sunil, K. Gupta, SC Lee</p></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span><span class=links><a href=/>DJMol Docs</a> > <a href=/documentation/>Documentation</a> > Chaper 2</span></div></div></div><div id=head-tags></div><div id=chapter><div id=body-inner><h1 id=chapter-2-dftb-calculations>Chapter 2: DFTB+ Calculations</h1><p>Here we illustrate some standard procedures that can be performed by the
DFTB+ program in conjunction with DJMol platform. At present there are
three distinct file types can be opened for DFTB+ calculations, viz.,
[1] dftb_in.hsd, &lt;.xyz> and &lt;.gen> files. The first one is the
default unique file type for the program and the  last two file
extensions can be converted into &lt;dftb_in.hsd> file by using a script
writer (see below section).</p><h4 id=1-dftb-script-writer>[1] DFTB+ Script Writer</h4><p>If one opens a &lt;.xyz> or &lt;.hsd> file, for visualizing the structure,
subsequently one can also try to make a corresponding &lt;dftb_in.hsd>
file using a DFTB+ script writer program. Using this, a user can make a
basic &lt;dftb_in.hsd> script for a range of jobs, including, geometry
optimization, calculating excited states or Hessian etc. It can be
retrieved by:</p><p>Set Up ➤ DFTB Scripting</p><p>And the generated &lt;dftb_in.hsd> file is kept in &lt;Input> folder.
Note that the atomic information including its geometry is directly
taken from &lt;gen> data of the currently loaded file.</p><p>Note that, the Script-Writer module will write &lt;TEMPdftb_in.hsd> into
the &lt;Input> folder. It is strongly recommended that, a user should
always try to inspect/modify this script before its submission, if it is
necessary.</p><p><img src=/images/image70.png alt></p><p>Figure 2.1: A screen shot of the script writer tool for the DFTB+
program.</p><h4 id=2-executing-dftb-scripts>[2] Executing DFTB+ Scripts</h4><p>Running DFTB+ calculator is possible when you load a &lt;dftb_in.hsd>
file. Make sure that the &lt;Input> folder should have this file before
the execution and this file can be executed as:</p><p>Execute ➤ Run DFTB+</p><p>And if necessary, this Run can be killed by</p><p>Execute ➤ Stop DFTB+</p><p>The generated/loaded files are usually placed in the`
&lt;DFTB_Scratch>filder. And these files are also sent back as a Zip
file, to the directory where your current &lt;hsd> file resides.</p><p>DFTB+ generated data can be analyzed or visualized by the program. Main
data analyzers are given below.</p><h4 id=3-force-components>[3] Force Components</h4><p>DFTB+ out file contains information about Cartesian force components (in
atomic units) and this can be visualized as a line chart as shown below.
The &lt;detailed.out> file can be opened by:</p><p>Tools ➤  ForceComponents</p><p><img src=/images/image74.png alt></p><p>Figure 2.2: The x components of the Cartesian forces of the Fullerene
molecule after the geometry optimization. The shaded portion can be
easily zoomed in for more details.</p><h4 id=4-molecular-orbitals-and-energy-levels>[4] Molecular Orbitals and Energy Levels</h4><p>MO information (including density and density difference files) are
stored in the .CUBE format. In order to get cube files one needs to
ensure that dftb_in.hsd file contains relevant keywords
(WriteDetailedXML  and WriteEigenvectors, see example directory for a
template file). After running this file it will produce 3 out files
(detailed.xml, charges.bin, and eigenvec.bin) and these files should be
transferred from &lt;DFTB_Scratch> directory to &lt;ModesBinary> folder.
 Then invoke:</p><p>Execute ➤ Run Waveplot</p><p>From this window, select the proper SK file set (look at the combo box
entitled, Specify SK set and Generate HSD file) and press on the button
&lt;Generate Waveplot File >. This will produce the needed HSD file for
the Waveplot.exe binary file. View this file from the second tab and
edit it if needed. Then invoke the &lt;Calculate> button to produce the
necessary CUBE file. Note that it might take some minutes to complete
the task (depending on the size of the system).</p><p>To visualize the cubes file, first copy the Full Path of the folder,
&lt;ModesBinary> and then go to:</p><p>Tools ➤ View Cube</p><p>Then click on the button, &lt;Open Directory> and insert the recently
copied Full Path into it and select a CUBE file. This will list all the
CUBE files into the table, and this can be visualized easily by
selecting the needed file name from the table and by clicking on the &lt;
Open> button. Optionally one can also use JMol scripting facility for
more advanced file visualizations or manipulations.</p><p><img src=/images/image73.png alt></p><p>Figure 2.3: Visual of one of the MOs from the list of CUBE files.</p><p>To view only MO energy levels and its degeneracies, one can use the
&lt;detailed.out> file and this can be called by:</p><p>Tools ➤  MO Levels</p><p>The green lines represent occupied and red lines represent the un
occupied levels. For accurate calculations (which use tight SCC
parameters) one can also look at the degeneracies levels.</p><p><img src=/images/image75.png alt></p><p>Figure 2.4: MO energy levels from the detailed.out file.</p><h4 id=5-uv-visible-spectrum-convolution>[5] UV-Visible Spectrum Convolution</h4><p>DFTB+ uses TD-DFTB for calculating oscillator strength of the optical
excitations and this is stored in SPX.dat file. An add-on is used for
reading this data and this can be invoked by:</p><p>Tools ➤  UV-Vis Spectrum</p><p>Select a SPX.dat file to proceed. This will plot the oscillator
strengths (vertical red lines) and its fitted function ( broadened
through convolution with a Gaussian, Lorentzian function or its linear
combination, known as pseudo-Voigt functions - shown by blue curves). By
default it uses eV however one can also obtain an equivalent spectrum
using nm units (this creates a separate plot). Note that the oscillator
strength is dimensionless quantity and it is described in the y axis.</p><p>By right clicking the plot, one can adjust several parameters (Auto
Range, Zoom, Grid Lines, Axes properties etc.) of the figure and can
save the image into PNG format.</p><p><img src=/images/image76.png alt></p><p>Figure 2.5: UV-Visible spectrum of an organic molecule fitted with
Lorentzian convolution.</p><h4 id=6-partial-charges>[6] Partial Charges</h4><p>DFTB+ caclulates partial charges and this charges can be projected out
into the individual atoms. This Utility can be invoked by:</p><p>Tools ➤ Partial Charges  </p><p>This utility read both the XYZ geometry and its corresponding
detailed.out file. A color scale will also be shown for a reference.
Note that this will generate a file and this file be saved for a
reference (See Appendix section for the Saved Data).</p><p><img src=/images/image77.png alt></p><p>Figure 2.6: Numerical values of Mulliken&rsquo;s partial charges are
represented on atoms</p><h4 id=7-molecular-vibrations>[7] Molecular Vibrations</h4><p>By using Harmonic approximation DFTB+ calculates the vibrational normal
modes and frequencies. This requires Hessian Matrix (calculated by the
DFTB+) and a script file for modes.exe binary (which calculates modes
and frequencies).</p><p>The first step is to optimize the geometry. And once the optimized
geometry is ready one can do the vibrational calculation with the
necessary keywords (it includes Driver = SecondDerivatives{} keywords;
See the example directory). This will generate the needed hessian.out
file for the modes.exe.</p><p>To calculate vibrational modes vectors, to visualize/animate these modes
and to get the frequencies, invoke the tool as:</p><p>Execute ➤ Run Modes</p><p>Here in this tool one has to enter the optimized GEN styled geometry</p><p>Geometry= GenFormat {</p><p>  &mldr;</p><p>}</p><p>and the hessian data as:</p><p>hessian = {</p><p>&mldr;</p><p>}</p><p>Note that the dots (&mldr;) represents the numerical value of the Hessian
matrix ie. ALL the numerical value of the file , hessian.out, which is
3Nx3N matrix data (force constant matrix).</p><p>After these two data entry select the corresponding SK file set and then
click on the button: Generate Script. This will generate modes_in.hsd
file in the ModesBinary folder. This file contains all the information
for the modes.exe program which diagonalizes the hessian matrix to give
modes/frequency information. The button, Generate Modes/Frequencies
initiate this operation and produces the file, modes.xyz which contains
the frequency/modes information.</p><p>To view this file another application is used this can be called by:</p><p>Tools ➤ View Modes</p><p>This will read the files modes.xyz and visualize the vectors/animations
etc. Note that the Hessian data is used by the modes.exe binary as such.
In other words it does not projects out translational and rotational
motions. So that the user should be optimize the molecule well enough.
If needed see <a href=http://gaussian.com/vib/>http://gaussian.com/vib/</a> on the projection technique of
Hessian matrix (Sayvetz conditions).</p><p><img src=/images/image78.png alt></p><p>Figure 2.7: Vibrational modes of water molecules read from the file
modes.xyz in the ModesBinary directory.</p><h4 id=8-real-time-molecular-dynamics>[8] Real Time Molecular Dynamics</h4><p>MD simulations can be done with or without using this tool. Normally one
can submit MD job as usual (like a static calculation job). However,
this MD tool is mainly used in real time so that a user can analyze
Trajectory properties (Total Energy, Kinetic/Potential Energies,
 structure of each step) at Run Time. Moreover FFT based autocorrelation
functions can be used to calculate IR spectra (from the dipole moments
or from the velocity autocorrelation functions) after finishing the MD
run. Note that, the MD analyzer tool should be invoked before the DFTB+
calculation. While running the MD calculation it will show</p><p>the progress of the data along with the current structure. Its step are:</p><p>[1] Remove all the files from ./DFTB_Scratch directory. It is Mandate.</p><p>[2] Open MD file as,                 File ➤ Open (hsd)</p><p>[3] Invoke the MD tool as,                 Tools ➤ MD  Analyzer</p><p>[4] Execute MD run as,                 Execute ➤ Run DFTB+</p><p>[5] Wait for the MD calculation to finish; and after that use tools
like, &lt;Velocity Autocorrelation Spectra>.</p><p><img src=/images/image58.png alt>  </p><p>Figure 2.8: Variations of energies during the MD, in real time.</p><h4 id=9-potential-energy-surfaces-2d1d>[9] Potential Energy Surfaces (2D/1D)</h4><p>The DJMol creates 2D PES (potential energy surface) by performing a
series of DFTB+ calculations. For example, PES of H2O2 (hydrogen
peroxide) molecule is created by doing a batch process. To create 2D PES
we need two independent internal coordinate variables and, arbitrarily,
we have chosen the O-O bond length and the H-H dihedral angle (in
degrees) as shown in Fig. X.</p><p><img src=/images/image59.png alt></p><p>Figure 2.9: The two independent variables of H2O2  PES. The unit of bond
length is in Angstrom and that of the dihedral angle is in degrees.</p><p>In first, make the structure of the molecule (or see Example folder for
its coordinates); then using the &lt;Convert Structure> tool (See Fig.2),
convert this XYZ formatted file into the MOPIN format (which contains an
equivalent z-matrix data). And copy the content of this file into
&lt;Build PES HSD> tool as shown in the Fig. 3.</p><p>By clicking the button, &lt;Generate PES HSD Files>, this will generate
441 HSD input files for the DFTB+ program (it will take around ten
minutes); copy all of these HSD files into the &lt;SCRATCH> folder (a
user can also select any other directory instead of this one) and then
invoke the &lt;Batch Processing Tool>. This will start DFTB+ program to
execute all these files and create the PES in the &lt;PESScan> folder.</p><p><img src=/images/image60.png alt></p><p> Figure 2.10: The Convert tool is used to transform Cartesian file into
a Mopin file (which essentially contain the z-matrix in Mopac’s format).</p><p> <img src=/images/image61.png alt></p><p>Figure 2.11: The converted MOPIN files content is inserted in the below
text area and insert the variable name in the appropriate position.
VariableI represents the O-O bond length (starts from 1.2Å) and
VariableII, it H-H dihedral angle (starts with 0.0 o).</p><p>After finishing the batch process, &lt;PESViewer> can be invoked to get
the plot of 2D PES or its contour diagram as shown in the Fig. 4. This
utility will also indicates the minimum energy data point on the PES (in
other words from this point one can start geometry optimization to
locate local minimum) and its corresponding geometry file.</p><p>In &lt;PESScan> folder one will see the following data files (See Table
6).</p><p>Table 6: Datafiles of PES calculations.</p><table><thead><tr><th>Datafile</th><th>Description</th></tr></thead><tbody><tr><td>View2DPES.dat</td><td>Gives the data intervals in x and y directions and energy as E(x,y) in eV</td></tr><tr><td>2DPESscan.dat</td><td>It contains the sorted file names used in the PES creation with energy (in eV and in Hartree). </td></tr><tr><td>2DPESscanmovie.xyz</td><td>Contains the geometry of the individual molecules in xyz format. It can be visualized/animated with DJMol. This can be userd to construct PES with other ab initio programs.</td></tr></tbody></table><p><img src=/images/image62.png alt></p><p><img src=/images/image63.png alt></p><p> Figure 2.12: The PES of the cis-trans conversion of H2O2 . Note that
the optimum bond length is around 1.48 Å and for shorter bond lengths
the energy minimum is located near to 90.0o or 270.0 o.</p><footer class=footline></footer></div></div></div><div id=navigation><a class="nav nav-prev" href=/documentation/chapter1/ title="Chaper 1"><i class="fa fa-chevron-left"></i></a><a class="nav nav-next" href=/documentation/chapter3/ title="Chaper 3" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1615995166></script><script src=/js/perfect-scrollbar.min.js?1615995166></script><script src=/js/perfect-scrollbar.jquery.min.js?1615995166></script><script src=/js/jquery.sticky.js?1615995166></script><script src=/js/featherlight.min.js?1615995166></script><script src=/js/highlight.pack.js?1615995166></script><script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1615995166></script><script src=/js/learn.js?1615995166></script><script src=/js/hugo-learn.js?1615995166></script><script src=/mermaid/mermaid.js?1615995166></script><script>mermaid.initialize({startOnLoad:!0})</script></body></html>